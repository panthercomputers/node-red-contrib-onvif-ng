<!--
  Original work:
  Copyright 2018 Bart Butenaers

  Modifications:
  Copyright 2025 Panther Computers

  Licensed under the Apache License, Version 2.0 (the "License");
-->
<script type="text/javascript">
RED.nodes.registerType('onvif-events', {
    category: 'ONVIF',
    color: '#ff758d',

    defaults: {
        name: { value: "" },
        deviceConfig: { value: "", type: "onvif-config", required: true },
        action: { value: "" }
    },

    inputs: 1,
    outputs: 1,
    icon: "event.png",

    label: function () {
        return this.name || "ONVIF Events";
    },

    oneditprepare: function () {
        // Nothing dynamic yet, but hook left intentionally
    },

    oneditsave: function () {
        if ($("#node-input-action").val() === "") {
            // Action may be supplied via msg.action
        }
    }
});
</script>

<script type="text/x-red" data-template-name="onvif-events">
    <div class="form-row">
        <label for="node-input-deviceConfig">
            <i class="fa fa-cog"></i> Device
        </label>
        <input type="text" id="node-input-deviceConfig">
    </div>

    <div class="form-row">
        <label for="node-input-action">
            <i class="fa fa-wrench"></i> Action
        </label>
        <select id="node-input-action">
            <option value="">— set via msg.action —</option>
            <option value="start">Start listening</option>
            <option value="stop">Stop listening</option>
            <option value="getEventProperties">Get event properties</option>
            <option value="getEventServiceCapabilities">Get event service capabilities</option>
            <option value="reconnect">Reconnect</option>
        </select>
    </div>

    <hr>

    <div class="form-row">
        <label for="node-input-name">
            <i class="fa fa-tag"></i> Name
        </label>
        <input type="text" id="node-input-name" placeholder="ONVIF Events">
    </div>
</script>

<script type="text/x-red" data-help-name="onvif-events">
    <p>
        <strong>ONVIF Events</strong>
    </p>
    <p>
        This node subscribes to and manages ONVIF event services on a compatible
        IP device.
    </p>
    <ul>
        <li><b>Start listening</b> — opens an event subscription</li>
        <li><b>Stop listening</b> — closes the subscription</li>
        <li><b>Get event properties</b> — retrieves supported event topics</li>
        <li><b>Get service capabilities</b> — retrieves event service capabilities</li>
    </ul>
    <p>
        If no action is selected, the action must be provided in
        <code>msg.action</code>.
    </p>
</script>
